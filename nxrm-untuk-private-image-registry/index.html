<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>NXRM untuk Private Image Registry - Anwar's Blog</title><meta name=Description content="Nexus Repository Manager Sebagai Private Image Registry"><meta property="og:title" content="NXRM untuk Private Image Registry"><meta property="og:description" content="Nexus Repository Manager Sebagai Private Image Registry"><meta property="og:type" content="article"><meta property="og:url" content="https://init.web.id/nxrm-untuk-private-image-registry/"><meta property="og:image" content="https://init.web.id/nxrm-untuk-private-image-registry/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-24T19:00:33+07:00"><meta property="article:modified_time" content="2021-05-24T21:35:33+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://init.web.id/nxrm-untuk-private-image-registry/cover.png"><meta name=twitter:title content="NXRM untuk Private Image Registry"><meta name=twitter:description content="Nexus Repository Manager Sebagai Private Image Registry"><meta name=application-name content="Anwar's Blog"><meta name=apple-mobile-web-app-title content="Anwar's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://init.web.id/nxrm-untuk-private-image-registry/><link rel=prev href=https://init.web.id/deployment-dengan-s2i-process-openshift/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"NXRM untuk Private Image Registry","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/init.web.id\/nxrm-untuk-private-image-registry\/"},"image":[{"@type":"ImageObject","url":"https:\/\/init.web.id\/nxrm-untuk-private-image-registry\/cover.png","width":1e3,"height":420}],"genre":"posts","keywords":"Nexus, Container, Registry, Repository","wordcount":1131,"url":"https:\/\/init.web.id\/nxrm-untuk-private-image-registry\/","datePublished":"2021-05-24T19:00:33+07:00","dateModified":"2021-05-24T21:35:33+07:00","license":"\u003ca href=\"https://creativecommons.org/licenses/by-nc/4.0/\" target=\"_blank\" rel=\"noopener\"\u003eCC BY-NC 4.0\u003c/a\u003e","publisher":{"@type":"Organization","name":"anwareset","logo":"https:\/\/github.com\/anwareset.png"},"author":{"@type":"Person","name":"anwareset"},"description":"Nexus Repository Manager Sebagai Private Image Registry"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'white'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'white'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Anwar's Blog"><span class=header-title-pre><i class="fas fa-hashtag"></i>&nbsp</span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Anwar's Blog"><span class=header-title-pre><i class="fas fa-hashtag"></i>&nbsp</span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">NXRM untuk Private Image Registry</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://init.web.id/about title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>anwareset</a></span>&nbsp;<span class=post-category>included in <a href=/categories/tools/><i class="far fa-folder fa-fw"></i>Tools</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-05-24>2021-05-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1131 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/nxrm-untuk-private-image-registry/cover.png data-srcset="/nxrm-untuk-private-image-registry/cover.png, /nxrm-untuk-private-image-registry/cover.png 1.5x, /nxrm-untuk-private-image-registry/cover.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/cover.png title="Nexus Repository Manager Sebagai Private Image Registry"></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#sonatype-nxrm>Sonatype NXRM</a></li><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#hardware-specifications>Hardware Specifications</a></li><li><a href=#system-requirements>System Requirements</a><ul><li><a href=#dedicated-user>Dedicated User</a></li><li><a href=#file-handle-limits>File Handle Limits</a></li><li><a href=#instal-java-runtime-environment>Instal Java Runtime Environment</a></li></ul></li></ul></li><li><a href=#instalasi>Instalasi</a><ul><li><a href=#download-nxrm>Download NXRM</a></li><li><a href=#edit-konfigurasi-nxrm>Edit Konfigurasi NXRM</a></li><li><a href=#selinux-label-dan-file-permission>SELinux Label dan File Permission</a></li><li><a href=#membuat-service-systemd>Membuat Service Systemd</a></li><li><a href=#chkconfig>chkconfig</a></li><li><a href=#buka-port-untuk-nxrm>Buka Port untuk NXRM</a></li><li><a href=#enable-service-nxrm>Enable Service NXRM</a></li><li><a href=#mengganti-password-admin>Mengganti Password Admin</a></li><li><a href=#create-repository>Create Repository</a></li><li><a href=#realm>Realm</a></li><li><a href=#buka-port-image-registry>Buka Port Image Registry</a></li></ul></li><li><a href=#pengujian>Pengujian</a><ul><li><a href=#insecure-registry>Insecure Registry</a></li><li><a href=#login-image-registry>Login Image Registry</a></li><li><a href=#push-container-image>Push Container Image</a></li><li><a href=#search-container-image>Search Container Image</a></li></ul></li><li><a href=#kesimpulan>Kesimpulan</a></li><li><a href=#referensi>Referensi</a></li></ul></nav></div></div><div class=content id=content><p>NXRM atau Nexus Repository Manager merupakan open source tool yang digunakan untuk mengelola repository multi-guna, meliputi Docker Image Registry, Java Maven, NPM, Rubygems, YUM, hingga APT. Private Repository sangat berguna bagi environment lokal yang tidak terhubung ke internet secara langsung, selain itu juga dapat digunakan untuk mengurangi penggunaan bandwidth internet, atau meningkatkan kecepatan <em>push and pull</em> image bagi container.</p><h2 id=sonatype-nxrm>Sonatype NXRM</h2><p><figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/nxrm.webp title=nxrm.webp data-thumbnail=/nxrm-untuk-private-image-registry/nxrm.webp data-sub-html="<h2>NXRM</h2><p>nxrm.webp</p>"><img class=lazyload src=/svg/loading.min.svg data-src=nxrm.webp data-srcset="/nxrm-untuk-private-image-registry/nxrm.webp, nxrm.webp 1.5x, /nxrm-untuk-private-image-registry/nxrm.webp 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/nxrm.webp></a><figcaption class=image-caption>NXRM</figcaption></figure></p><p>Sonatype merilis NXRM menjadi dua macam, yaitu OSS (Open Source Software) yang dapat digunakan tanpa biaya, dan Pro yang memiliki beberapa fitur unggulan tambahan. Terkait komparasi antara kedua versi tersebut dapat dilihat pada link <a href=https://www.sonatype.com/products/repository-oss-vs-pro-features target=_blank rel="noopener noreffer">berikut</a> atau <a href=https://sonatype.drift.click/oss-vs-pro target=_blank rel="noopener noreffer">ini</a>.</p><hr><h2 id=prerequisites>Prerequisites</h2><p>Nexus memerlukan beberapa prasyarat yang harus dipenuhi sebelum instalasi seperti berikut.</p><h3 id=hardware-specifications>Hardware Specifications</h3><p>Pada saat artikel ini ditulis, saya akan menggunakan Nexus Repository Manager 3. NXRM membutuhkan spesifikasi hardware minimum seperti berikut:</p><ul><li>8GB RAM</li><li>4 CPUs</li><li>500GB disk space</li></ul><p>Terdengar lumayan besar, namun hal ini adalah hal yang wajar dalam membangun sebuah repository server. Image Registry akan membutuhkan storage yang besar, dan disk space yang kurang besar akan dengan mudah menjadi penuh nantinya. Tetapi karena dalam artikel ini saya hanya ingin melakukan percobaan saja, maka <em>saya cukup menggunakan 20GB storage</em> saja.</p><h3 id=system-requirements>System Requirements</h3><p>Nexus dapat dipasang langsung diatas VM/OS atau bisa juga dijalankan di dalam container, dalam artikel ini saya akan langsung memasangnya diatas VM yang menggunakan distro <strong>RHEL 8</strong>. Sebelum lebih lanjut, kita perlu melakukan beberapa hal berikut agar NXRM dapat berjalan.</p><h4 id=dedicated-user>Dedicated User</h4><p>Buat sebuah user, misalnya bernama <code>nexus</code> dengan perintah berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo useradd nexus
</code></pre></td></tr></table></div></div><p>Kemudian berikan password pada user tersebut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo passwd nexus
</code></pre></td></tr></table></div></div><p>Kita hendaknya tidak pernah menjalankan Nexus menggunakan user <code>root</code>. Nantinya user <code>nexus</code> inilah yang akan kita pakai untuk menjalankan Nexus.</p><h4 id=file-handle-limits>File Handle Limits</h4><p>Tambahkan batasan <em>file handle</em> pada file <code>/etc/security/limits.conf</code> bagi user yang telah kita buat.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>nexus - nofile 65536
</code></pre></td></tr></table></div></div><h4 id=instal-java-runtime-environment>Instal Java Runtime Environment</h4><p>NXRM membutuhkan setidaknya JRE 8 untuk berjalan, jika belum ada maka pasang terlebih dahulu.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo dnf install -y java-1.8.0-openjdk
</code></pre></td></tr></table></div></div><p>Di artikel ini saya menggunakan OpenJDK 1.8.0 sebagai Java Runtime Environment.</p><hr><h2 id=instalasi>Instalasi</h2><p>Berikut ini adalah langkah-langkah yang dilakukan untuk memasang dan menjalankan NXRM pada RHEL 8.</p><h3 id=download-nxrm>Download NXRM</h3><p>Jalankan perintah berikut untuk mengunduh NXRM. Kemudian extract ke direktori <code>/opt</code> seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>wget https://download.sonatype.com/nexus/3/latest-unix.tar.gz 
sudo tar xvf latest-unix.tar.gz -C /opt/
</code></pre></td></tr></table></div></div><h3 id=edit-konfigurasi-nxrm>Edit Konfigurasi NXRM</h3><p>Ubah beberapa konfigurasi yang diperlukan pada <code>/opt/nexus*/bin/nexus.rc</code> untuk memasukkan user yang akan digunakan untuk menjalankan proses.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>run_as_user=&#34;nexus&#34;
</code></pre></td></tr></table></div></div><p>Sedangkan <code>/opt/nexus*/bin/nexus.vmoptions</code> akan digunakan untuk konfigurasi yang berkaitan dengan Runtime Environment.</p><h3 id=selinux-label-dan-file-permission>SELinux Label dan File Permission</h3><p>Ubah user dan group owner pada direktori nexus.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo chown -R nexus:nexus /opt/nexus*
sudo chown -R nexus:nexus /opt/sonatype-work
</code></pre></td></tr></table></div></div><p>Tambahkan SELinux label yang sesuai pada direktori nexus tersebut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo semanage fcontext -a -t initrc_t <span class=s2>&#34;/opt/nexus*(/.*)?&#34;</span>
sudo semanage fcontext -a -t initrc_exec_t <span class=s2>&#34;/opt/nexus*(/.*)?&#34;</span>
sudo restorecon -Rv /opt/nexus*
</code></pre></td></tr></table></div></div><h3 id=membuat-service-systemd>Membuat Service Systemd</h3><p>Jika kita memakai Systemd sebagai init system, maka kita perlu membuat sebuah file service baru.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo vi /etc/systemd/system/nexus.service
</code></pre></td></tr></table></div></div><p>Di dalamnya bisa diisi konfigurasi seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>[Unit]
Description=Nexus Service
After=network.target
  
[Service]
Type=forking
LimitNOFILE=65536
ExecStart=/opt/nexus-3.30.1-01/bin/nexus start
ExecStop=/opt/nexus-3.30.1-01/bin/nexus stop
User=nexus
Group=nexus
Restart=on-abort
TimeoutSec=600
  
[Install]
WantedBy=multi-user.target
</code></pre></td></tr></table></div></div><p>Dengan menjadikan NXRM sebagai Service, maka NXRM dapat berjalan secara otomatis apabila OS mengalami reboot. Pastikan juga file systemd service tersebut mempunyai permission yang benar.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo chmod <span class=m>644</span> /etc/systemd/system/nexus.service
</code></pre></td></tr></table></div></div><h3 id=chkconfig>chkconfig</h3><p>Jalankan perintah <code>chkconfig</code> seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo chkconfig nexus on
</code></pre></td></tr></table></div></div><h3 id=buka-port-untuk-nxrm>Buka Port untuk NXRM</h3><p>Karena by-default <code>firewalld</code> tidak memperbolehkan akses port dari luar, maka kita perlu membukanya.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo firewall-cmd --permanent --add-port<span class=o>=</span>8081/tcp
sudo firewall-cmd --reload
</code></pre></td></tr></table></div></div><p>NXRM akan listening pada port 8081 supaya dapat diakses melalui web browser.</p><h3 id=enable-service-nxrm>Enable Service NXRM</h3><p>Enable service NXRM supaya ikut berjalan otomatis bersama OS saat pertamakali dihidupkan.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo systemctl daemon-reload
sudo systemctl <span class=nb>enable</span> --now nexus.service
</code></pre></td></tr></table></div></div><h3 id=mengganti-password-admin>Mengganti Password Admin</h3><p>Dapatkan password bawaan dari NXRM untuk login melalui web browser yang disimpan pada <code>/opt/sonatype-work/nexus3/admin.password</code> seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo cat /opt/sonatype-work/nexus3/admin.password
</code></pre></td></tr></table></div></div><p>Lalu buka alamat IP port 8081 pada web browser, dan login menggunakan user <code>admin</code> dan password diatas.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/ganti-password.png title=ganti-password.png data-thumbnail=/nxrm-untuk-private-image-registry/ganti-password.png data-sub-html="<h2>Ganti Password</h2><p>ganti-password.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=ganti-password.png data-srcset="/nxrm-untuk-private-image-registry/ganti-password.png, ganti-password.png 1.5x, /nxrm-untuk-private-image-registry/ganti-password.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/ganti-password.png></a><figcaption class=image-caption>Ganti Password</figcaption></figure></p><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw"></i>Perhatian<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><code>192.168.122.3</code> merupakan IP dari VM yang saya jalankan untuk memasang NXRM, sesuaikan dengan environment kalian masing-masing.</div></div></div><h3 id=create-repository>Create Repository</h3><p>Buat repository baru yang akan kita gunakan sebagai image registry. Silahkan centang sesuai gambar berikut.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/membuat-repository.png title=membuat-repository.png data-thumbnail=/nxrm-untuk-private-image-registry/membuat-repository.png data-sub-html="<h2>Membuat Repository</h2><p>membuat-repository.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=membuat-repository.png data-srcset="/nxrm-untuk-private-image-registry/membuat-repository.png, membuat-repository.png 1.5x, /nxrm-untuk-private-image-registry/membuat-repository.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/membuat-repository.png></a><figcaption class=image-caption>Membuat Repository</figcaption></figure>Pada artikel ini, saya akan menggunakan port 5000 untuk Image Registry.</p><h3 id=realm>Realm</h3><p>Aktifkan <em>Docker Bearer Token Realm</em>.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/mengaktifkan-realm.png title=mengaktifkan-realm.png data-thumbnail=/nxrm-untuk-private-image-registry/mengaktifkan-realm.png data-sub-html="<h2>Mengaktifkan Realm</h2><p>mengaktifkan-realm.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=mengaktifkan-realm.png data-srcset="/nxrm-untuk-private-image-registry/mengaktifkan-realm.png, mengaktifkan-realm.png 1.5x, /nxrm-untuk-private-image-registry/mengaktifkan-realm.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/mengaktifkan-realm.png></a><figcaption class=image-caption>Mengaktifkan Realm</figcaption></figure></p><h3 id=buka-port-image-registry>Buka Port Image Registry</h3><p>Kita perlu membuka port 5000 supaya dapat diakses dari luar.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo firewall-cmd --permanent --add-port<span class=o>=</span>5000/tcp
sudo firewall-cmd --reload
</code></pre></td></tr></table></div></div><hr><h2 id=pengujian>Pengujian</h2><p>Dari sini saja harusnya kita sudah dapat menggunakan Image Registry di dalam NXRM yang sudah kita buat.</p><h3 id=insecure-registry>Insecure Registry</h3><p>Karena kita tidak mengaktifkan SSL yang sah pada repository Image Registry maka kita perlu menambahkan address Registry tersebut ke dalam Insecure Registry. Jika <strong>memakai Docker</strong> sebagai Container Runtime, maka buat file <code>/etc/docker/daemon.json</code> dan isi seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
	<span class=nt>&#34;insecure-registries&#34;</span><span class=p>:</span> <span class=p>[</span> <span class=s2>&#34;192.168.122.3:5000&#34;</span> <span class=p>]</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Lalu restart Docker Service jika menggunakan Systemd.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>sudo systemctl restart docker.service
</code></pre></td></tr></table></div></div><p>Jika <strong>menggunakan Podman</strong> sebagai Container Runtime, maka buka file <code>/etc/containers/registries.conf</code> kemudian edit isinya pada bagian berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>[registries.insecure]
registries = [&#39;192.168.122.3:5000&#39;]
</code></pre></td></tr></table></div></div><p>Karena Podman merupakan <em>daemonless</em> maka kita tidak perlu melakukan restart service apapun.</p><h3 id=login-image-registry>Login Image Registry</h3><p>Sekarang coba login ke dalam Image Registry menggunakan user <code>admin</code> dan password yang sudah kita buat.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>docker login -u admin 192.168.122.3:5000
</code></pre></td></tr></table></div></div><p>Jika berhasil maka akan muncul tampilan seperti berikut.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/docker-login.png title=docker-login.png data-thumbnail=/nxrm-untuk-private-image-registry/docker-login.png data-sub-html="<h2>Docker Login</h2><p>docker-login.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=docker-login.png data-srcset="/nxrm-untuk-private-image-registry/docker-login.png, docker-login.png 1.5x, /nxrm-untuk-private-image-registry/docker-login.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/docker-login.png></a><figcaption class=image-caption>Docker Login</figcaption></figure></p><p>Sedangkan jika menggunakan Podman adalah seperti berikut.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/podman-login.png title=podman-login.png data-thumbnail=/nxrm-untuk-private-image-registry/podman-login.png data-sub-html="<h2>Podman Login</h2><p>podman-login.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=podman-login.png data-srcset="/nxrm-untuk-private-image-registry/podman-login.png, podman-login.png 1.5x, /nxrm-untuk-private-image-registry/podman-login.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/podman-login.png></a><figcaption class=image-caption>Podman Login</figcaption></figure></p><h3 id=push-container-image>Push Container Image</h3><p>Sebelumnya saya telah memiliki sebuah Container Image bernama <code>localhost/mycompany</code> dan akan coba saya push ke Image Registry.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/container-image.png title=container-image.png data-thumbnail=/nxrm-untuk-private-image-registry/container-image.png data-sub-html="<h2>Container Image</h2><p>container-image.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=container-image.png data-srcset="/nxrm-untuk-private-image-registry/container-image.png, container-image.png 1.5x, /nxrm-untuk-private-image-registry/container-image.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/container-image.png></a><figcaption class=image-caption>Container Image</figcaption></figure></p><p>Pertama saya akan merubah tag Image tersebut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>podman tag localhost/mycompany 192.168.122.3:5000/mycompany
podman images
</code></pre></td></tr></table></div></div><p>Kemudian kita push container image tersebut menuju Image Registry.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>podman push 192.168.122.3:5000/mycompany
</code></pre></td></tr></table></div></div><p>Jika berhasil, maka kira-kira akan muncul tampilan seperti berikut.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/push-image.png title=push-image.png data-thumbnail=/nxrm-untuk-private-image-registry/push-image.png data-sub-html="<h2>Push Image</h2><p>push-image.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=push-image.png data-srcset="/nxrm-untuk-private-image-registry/push-image.png, push-image.png 1.5x, /nxrm-untuk-private-image-registry/push-image.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/push-image.png></a><figcaption class=image-caption>Push Image</figcaption></figure></p><h3 id=search-container-image>Search Container Image</h3><p>Kita dapat mencari container image yang tersedia pada NXRM langsung melalui Docker atau Podman.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>podman search 192.168.122.3:5000/
</code></pre></td></tr></table></div></div><p>Akan terlihat container image yang tersedia di dalam image registry pada NXRM.<figure><a class=lightgallery href=/nxrm-untuk-private-image-registry/search-image.png title=search-image.png data-thumbnail=/nxrm-untuk-private-image-registry/search-image.png data-sub-html="<h2>Search Image</h2><p>search-image.png</p>"><img class=lazyload src=/svg/loading.min.svg data-src=search-image.png data-srcset="/nxrm-untuk-private-image-registry/search-image.png, search-image.png 1.5x, /nxrm-untuk-private-image-registry/search-image.png 2x" data-sizes=auto alt=/nxrm-untuk-private-image-registry/search-image.png></a><figcaption class=image-caption>Search Image</figcaption></figure></p><hr><h2 id=kesimpulan>Kesimpulan</h2><p>Sebenarnya masih banyak yang fitur yang tersedia dan perlu saya coba pada NXRM, namun saya rasa artikel kali ini sudah cukup panjang dan membosankan. Salah satu yang menarik adalah kita dapat menerapkan konsep <em>High Availability</em> dengan membangun sebuah Nexus Cluster menggunakan beberapa server sekaligus, sayangnya saya belum dapat mencobanya karena keterbatasan <em>resource</em>. Dari pengalaman saya di tempat kerja, Nexus dari Sonatype memang sangat sering digunakan oleh perusahan baik <em>Telco</em> maupun <em>Banking</em> untuk membangun sebuah Private Repository Manager, tidak cuma meng-<em>handle</em> Image Registry namun juga YUM Repository bagi distro RHEL yang berjalan sebagai node pada cluster container oschestration seperti Kubernetes.</p><hr><h2 id=referensi>Referensi</h2><ul><li><a href=help.sonatype.com/repomanager3/installation/system-requirements rel>https://help.sonatype.com/repomanager3/installation/system-requirements</a></li><li><a href=help.sonatype.com/repomanager3/installation/run-as-a-service rel>https://help.sonatype.com/repomanager3/installation/run-as-a-service</a></li><li><a href=help.sonatype.com/repomanager3/formats/docker-registry/pushing-images rel>https://help.sonatype.com/repomanager3/formats/docker-registry/pushing-images</a></li><li><a href=help.sonatype.com/repomanager3/installation/configuring-the-runtime-environment rel>https://help.sonatype.com/repomanager3/installation/configuring-the-runtime-environment</a></li><li><a href=www.redhat.com/sysadmin/manage-container-registries rel>https://www.redhat.com/sysadmin/manage-container-registries</a></li><li><a href=docs.podman.io/en/latest/markdown/podman-pull.1.html rel>http://docs.podman.io/en/latest/markdown/podman-pull.1.html</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-05-24</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/nexus/>Nexus</a>,&nbsp;<a href=/tags/container/>Container</a>,&nbsp;<a href=/tags/registry/>Registry</a>,&nbsp;<a href=/tags/repository/>Repository</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/deployment-dengan-s2i-process-openshift/ class=prev rel=prev title="Deployment dengan S2I Process OpenShift"><i class="fas fa-angle-left fa-fw"></i>Deployment dengan S2I Process OpenShift</a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=http://github.com/anwareset target=_blank>anwareset</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=https://anwars-blog.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},data:{"id-1":"init\u0026nbsp","id-2":"init\u0026nbsp"},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},typeit:{cursorChar:"\u0026nbsp _",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:75}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>