<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Virtualisasi Infrastruktur dengan oVirt - Anwar's Blog</title><meta name=Description content="Mengelola Virtualisasi Infrastruktur Datacenter menggunakan oVirt"><meta property="og:title" content="Virtualisasi Infrastruktur dengan oVirt"><meta property="og:description" content="Mengelola Virtualisasi Infrastruktur Datacenter menggunakan oVirt"><meta property="og:type" content="article"><meta property="og:url" content="https://init.web.id/virtualisasi-infrastruktur-dengan-ovirt/"><meta property="og:image" content="https://init.web.id/virtualisasi-infrastruktur-dengan-ovirt/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-30T00:02:32+07:00"><meta property="article:modified_time" content="2021-11-30T18:17:00+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://init.web.id/virtualisasi-infrastruktur-dengan-ovirt/cover.png"><meta name=twitter:title content="Virtualisasi Infrastruktur dengan oVirt"><meta name=twitter:description content="Mengelola Virtualisasi Infrastruktur Datacenter menggunakan oVirt"><meta name=application-name content="Anwar's Blog"><meta name=apple-mobile-web-app-title content="Anwar's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://init.web.id/virtualisasi-infrastruktur-dengan-ovirt/><link rel=prev href=https://init.web.id/monitoring-kubernetes-dengan-influxdb-v2/><link rel=next href=https://init.web.id/plug-and-play-usb-devices-dengan-udev-rules/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Virtualisasi Infrastruktur dengan oVirt","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/init.web.id\/virtualisasi-infrastruktur-dengan-ovirt\/"},"image":[{"@type":"ImageObject","url":"https:\/\/init.web.id\/virtualisasi-infrastruktur-dengan-ovirt\/cover.png","width":3840,"height":2160}],"genre":"posts","keywords":"Virtualization, oVirt, RHEV, RHV, Hypervisor, Infrastructure","wordcount":2263,"url":"https:\/\/init.web.id\/virtualisasi-infrastruktur-dengan-ovirt\/","datePublished":"2021-11-30T00:02:32+07:00","dateModified":"2021-11-30T18:17:00+07:00","license":"\u003ca href=\"https://creativecommons.org/licenses/by-nc/4.0/\" target=\"_blank\" rel=\"noopener\"\u003eCC BY-NC 4.0\u003c/a\u003e","publisher":{"@type":"Organization","name":"anwareset","logo":"https:\/\/github.com\/anwareset.png"},"author":{"@type":"Person","name":"anwareset"},"description":"Mengelola Virtualisasi Infrastruktur Datacenter menggunakan oVirt"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"light"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"light"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Anwar's Blog"><span class=header-title-pre><i class='fas fa-hashtag'></i>&nbsp</span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Anwar's Blog"><span class=header-title-pre><i class='fas fa-hashtag'></i>&nbsp</span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Virtualisasi Infrastruktur dengan oVirt</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://init.web.id/about title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>anwareset</a></span>&nbsp;<span class=post-category>included in <a href=/categories/platform/><i class="far fa-folder fa-fw"></i>Platform</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-11-30>2021-11-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2263 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;11 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/virtualisasi-infrastruktur-dengan-ovirt/cover.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/cover.png, /virtualisasi-infrastruktur-dengan-ovirt/cover.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/cover.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/cover.png title="Mengelola Virtualisasi Infrastruktur Datacenter menggunakan oVirt"></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#tentang-ovirt>Tentang oVirt</a><ul><li><a href=#fitur-dasar>Fitur Dasar</a></li></ul></li><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#metode>Metode</a></li><li><a href=#host>Host</a></li><li><a href=#network>Network</a></li><li><a href=#spesifikasi-host>Spesifikasi Host</a></li><li><a href=#nfs-server>NFS Server</a></li></ul></li><li><a href=#self-hosted-engine>Self-hosted Engine</a><ul><li><a href=#vm-settings>VM Settings</a></li><li><a href=#deployment-progress>Deployment Progress</a></li><li><a href=#storage-domain>Storage Domain</a></li><li><a href=#healthcheck-hosted-engine>Healthcheck Hosted Engine</a></li><li><a href=#ovirt-webmanager>oVirt Webmanager</a></li></ul></li><li><a href=#add-host>Add Host</a></li><li><a href=#upload-iso>Upload ISO</a><ul><li><a href=#mountpoint-iso>Mountpoint ISO</a></li><li><a href=#new-storage-domain>New Storage Domain</a></li><li><a href=#enable-user>Enable User</a></li><li><a href=#lokasi-direktori>Lokasi Direktori</a></li><li><a href=#rsync-file>Rsync File</a></li><li><a href=#disable-user>Disable User</a></li><li><a href=#check-iso-file>Check ISO File</a></li></ul></li><li><a href=#create-vm>Create VM</a><ul><li><a href=#new-vm>New VM</a></li><li><a href=#install-os-on-vm-with-iso>Install OS on VM with ISO</a></li><li><a href=#eject-iso>Eject ISO</a></li><li><a href=#uji-coba>Uji Coba</a></li></ul></li><li><a href=#kesimpulan>Kesimpulan</a></li><li><a href=#referensi>Referensi</a></li></ul></nav></div></div><div class=content id=content><p><a href=https://ovirt.org target=_blank rel="noopener noreffer"><strong>oVirt</strong></a> adalah virtualization platform untuk mengelola infrastruktur datacenter. Hypervisor yang dipakai adalah <a href=https://www.linux-kvm.org target=_blank rel="noopener noreffer"><code>KVM</code></a>, lalu <a href=httpd://libvirt.org target=_blank rel="noopener noreffer"><code>libvirt</code></a> digunakan sebagai interface lewat API dan berkomunikasi dengan <a href=https://www.ovirt.org/develop/developer-guide/vdsm/vdsm.html target=_blank rel="noopener noreffer"><code>VDSM</code></a> sehingga dapat hadir dalam bentuk tampilan Web. Artikel ini hanya membahas setup oVirt Node dengan <em>Self-hosted Engine</em> hingga menjalankan <em>guest VM</em>.</p><h2 id=tentang-ovirt>Tentang oVirt</h2><p>Pada awalnya oVirt adalah project open source bernama <a href=http://www.desktop-virtualization.com/2008/05/01/qumranet-solid-ice target=_blank rel="noopener noreffer">Solid ICE</a>, dikembangkan oleh perusahaan <a href=https://www.redhat.com/en/about/press-releases/qumranet target=_blank rel="noopener noreffer">Qumranet</a>. Lalu <a href=http://www.desktop-virtualization.com/2008/09/09/redhat-acquires-qumranet-for-107m target=_blank rel="noopener noreffer">Red Hat mengakuisisi project tersebut</a> dan mengganti namanya menjadi oVirt, kedepannya oVirt menjadi upstream dari produk bernama Red Hat Enterprise Virtualization (biasa disingkat sebagai RHEV atau RHV).</p><p>Pada saat artikel ini diterbitkan, installer atau ISO dari Red Hat Virtualization versi <em>latest stable</em> yang tersedia adalah <a href=https://access.redhat.com/downloads/content/415/ target=_blank rel="noopener noreffer"><strong>RHVH 4.4 (Red Hat Virtualization Host)</strong></a>, sedangkan dalam artikel ini saya akan menggunakan <a href=https://resources.ovirt.org/pub/ovirt-4.4/iso/ovirt-node-ng-installer/ target=_blank rel="noopener noreffer"><strong>oVirt Node 4.4.9</strong></a>. Sebetulnya kita dapat membangun klaster oVirt dan RHV <a href=Red_Hat_Enterprise_Linux_hosts_SHE_cockpit_deploy rel>menggunakan distro Enterprise Linux seperti CentOS atau RHEL</a>, tapi saya rasa akan lebih mudah jika memakai distro yang disediakan oleh oVirt atau RHV, yang memang sudah didesain sedemikian rupa sehingga memudahkan kita dalam proses <em>setup</em>.</p><h3 id=fitur-dasar>Fitur Dasar</h3><p>Berikut ini adalah beberapa fitur dasar yang akan memudahkan kita dalam mengelola virtualisasi infrastruktur ketika menggunakan oVirt.</p><ul><li>Web Interface yang ramah pengguna bagi administrator dan user non-admin</li><li>Manajemen terintegrasi bagi host, storage, dan konfigurasi network</li><li>Live Migration bagi virtual machine dan disk antar host dan storage</li><li>High availability bagi virtual machine</li></ul><hr><h2 id=prerequisites>Prerequisites</h2><h3 id=metode>Metode</h3><p>Kita dapat melakukan instalasi file ISO oVirt Node ke komputer fisik (baremetal) pada datacenter, namun karena keterbatasan <em>resource</em> saya akan melakukannya dalam VM di komputer supaya lebih fleksibel. Ada beberapa macam jenis instalasi yang bisa kita lakukan, kurang lebihnya seperti:</p><ol><li><p><strong>Self-hosted Engine</strong>.
Cara inilah yang akan kita terapkan, karena cenderung lebih <em>simple</em>. Pertama kita lakukan instalasi file ISO oVirt Node, lalu dalam OS tersebut kita <em>deploy</em> sebuah VM yang bertugas sebagai <em>Engine</em> atau <em>Manager</em>.</p></li><li><p><strong>Standalone Manager</strong>.
Menurut saya cara ini lebih rumit, namun akan cocok jika ingin mencapai performa yang lebih baik. Karena satu mesin tersebut hanya didedikasikan untuk fokus menjalankan satu OS sebagai <em>Engine</em> atau <em>Manager</em>.</p></li></ol><h3 id=host>Host</h3><p>Sebuah <strong>Host</strong> dalam oVirt mirip seperti <strong>Worker Node</strong> pada klaster <a href=https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/ target=_blank rel="noopener noreffer">Kubernetes</a>. <em>Jika Worker Node di Kubernetes menjalankan Pod, maka Host di oVirt akan menjalankan VM</em>. Terlalu menyederhanakan, tapi kurang lebih bagi saya memang seperti itu tugasnya. Ibarat sebuah Pod, kelak VM dalam Host bisa di-<em>migrate</em> ke Host lain.</p><p>Saya akan menggunakan dua VM sebagai Host oVirt. VM ini berjalan di atas komputer saya menggunakan <code>KVM</code> dengan bantuan <code>virsh</code>. Kedua VM akan saya sebut sebagai <strong>host</strong> dan kita install ISO oVirt Node. Nantinya salah satu dari host ini akan menjalankan sebuah VM di dalamnya yang dijuluki <em>Self-hosted Engine</em> sebagai Manager dari keseluruhan oVirt. Manager tersebut akan kita pakai untuk mengelola klaster oVirt. Jika digambarkan kurang lebih akan terlihat seperti berikut.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine.png title="Self-hosted Engine" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine.png data-sub-html="<h2>Self-hosted Engine</h2><p>Self-hosted Engine</p>"><img class=lazyload src=/svg/loading.min.svg data-src=self-hosted-engine.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine.png, self-hosted-engine.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine.png></a><figcaption class=image-caption>Self-hosted Engine</figcaption></figure></p><p>Untuk proses instalasi ISO oVirt Node pada masing-masing host terbilang relatif mudah, karenanya saya anggap tidak perlu dijelaskan pada artikel ini.</p><h3 id=network>Network</h3><p>Saya tidak ingin IP kedua host tersebut berubah, maka kita perlu menyesuaikan konfigurasi <em>virtual network</em> KVM pada komputer menggunakan <code>virsh</code> seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo virsh net-edit default
</span></span></code></pre></td></tr></table></div></div><p>Masukkan masing-masing MAC address dari virtual NIC kedua VM host, misalnya seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;network&gt;
</span></span><span class=line><span class=cl>  &lt;name&gt;default&lt;/name&gt;
</span></span><span class=line><span class=cl>  &lt;uuid&gt;85633c91-ef79-4ab7-8835-295b046c7xxx&lt;/uuid&gt;
</span></span><span class=line><span class=cl>  &lt;forward mode=&#39;nat&#39;/&gt;
</span></span><span class=line><span class=cl>  &lt;bridge name=&#39;virbr0&#39; stp=&#39;on&#39; delay=&#39;0&#39;/&gt;
</span></span><span class=line><span class=cl>  &lt;mac address=&#39;52:54:00:bn:6f:15&#39;/&gt;
</span></span><span class=line><span class=cl>  &lt;ip address=&#39;192.168.122.1&#39; netmask=&#39;255.255.255.0&#39;&gt;
</span></span><span class=line><span class=cl>    &lt;dhcp&gt;
</span></span><span class=line><span class=cl>      &lt;range start=&#39;192.168.122.50&#39; end=&#39;192.168.122.159&#39;/&gt;
</span></span><span class=line><span class=cl>      &lt;host mac=&#39;52:54:00:b8:77:94&#39; name=&#39;host1.ovirt.local&#39; ip=&#39;192.168.122.20&#39;/&gt;
</span></span><span class=line><span class=cl>      &lt;host mac=&#39;52:54:00:fa:df:2d&#39; name=&#39;host2.ovirt.local&#39; ip=&#39;192.168.122.21&#39;/&gt;
</span></span><span class=line><span class=cl>    &lt;/dhcp&gt;
</span></span><span class=line><span class=cl>  &lt;/ip&gt;
</span></span><span class=line><span class=cl>&lt;/network&gt;
</span></span></code></pre></td></tr></table></div></div><p>Artinya <em>virtual network</em> KVM pada komputer kita hanya akan memulai alokasi DHCP dari <code>192.168.122.50</code> sampai <code>192.168.122.159</code>, sementara kedua MAC yang kita masukkan tidak berubah karena dijadikan static, dengan IP <code>192.168.122.20</code> untuk <code>host1.ovirt.local</code> dan IP <code>192.168.122.21</code> untuk <code>host2.ovirt.local</code>.</p><p>Karena deployment <em>hosted-engine</em> nantinya akan melakukan <em>lookup</em> hostname dan kita tidak menggunakan server DNS pada artikel ini, maka selanjutnya kita perlu menambahkan konfigurasi pada <code>/etc/hosts</code> di komputer, kedua host, serta VM Self-hosted Engine seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>192.168.122.20  host1.ovirt.local
</span></span><span class=line><span class=cl>192.168.122.21  host2.ovirt.local
</span></span><span class=line><span class=cl>192.168.122.15  hosted-engine.ovirt.local
</span></span></code></pre></td></tr></table></div></div><h3 id=spesifikasi-host>Spesifikasi Host</h3><p>Karena hanya untuk keperluan belajar, saya meminimalisir penggunakan <em>resource</em> agar efisien. Kedua host yang sudah saya persiapkan menggunakan spesifikasi seperti berikut.</p><table><thead><tr><th style=text-align:center>Host</th><th style=text-align:center>vCPU cores</th><th style=text-align:center>Memory</th><th style=text-align:center>Disk</th><th style=text-align:center>Additional Disk</th></tr></thead><tbody><tr><td style=text-align:center>host1.ovirt.local</td><td style=text-align:center>1</td><td style=text-align:center>8 GB</td><td style=text-align:center>65 GB</td><td style=text-align:center>65 GB</td></tr><tr><td style=text-align:center>host2.ovirt.local</td><td style=text-align:center>1</td><td style=text-align:center>2 GB</td><td style=text-align:center>65 GB</td><td style=text-align:center>-</td></tr></tbody></table><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw"></i>Tips<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Pada <code>host1.ovirt.local</code> diperlukan tambahan disk yang nantinya dijadikan sebagai NFS server. Setelah instalasi VM Self-hosted Engine selesai, memori pada host ini juga dapat kita resize sesuai kebutuhan, misalnya kita turunkan menjadi 5 GB. Jumlah memori awal sebesar 8 GB hanyalah untuk mencegah terjadinya kegagalan ketika proses deployment yang disebabkan oleh minimnya ketersediaan memori.</div></div></div><h3 id=nfs-server>NFS Server</h3><p>Setidaknya sebuah Storage Domain dibutuhkan dalam Datacenter oVirt, dan kita dapat menambahkan beberapa jenis storage seperti misalnya NFS server. Pada sebelumnya kita telah menambahkan disk tambahan pada <code>host1.ovirt.local</code> anggaplah terbaca sebagai <code>/dev/vdb</code> dan akan kita gunakan sebagai filesystem bagi NFS. Supaya lebih efisien, dalam artikel ini NFS server akan saya bangun juga pada <code>host1.ovirt.local</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[root@host1 ~]# parted /dev/vdb
</span></span><span class=line><span class=cl>GNU Parted 3.2
</span></span><span class=line><span class=cl>Using /dev/vdb
</span></span><span class=line><span class=cl>Welcome to GNU Parted! Type &#39;help&#39; to view a list of commands.
</span></span><span class=line><span class=cl>(parted) mklabel msdos
</span></span><span class=line><span class=cl>Warning: The existing disk label on /dev/vdb will be destroyed and all data on this disk will be lost.
</span></span><span class=line><span class=cl>Do you want to continue?
</span></span><span class=line><span class=cl>Yes/No? Yes                                                               
</span></span><span class=line><span class=cl>(parted) mkpart                                                           
</span></span><span class=line><span class=cl>Partition type?  primary/extended? primary                                
</span></span><span class=line><span class=cl>File system type?  [ext2]? xfs                                            
</span></span><span class=line><span class=cl>Start? 0%                                                                 
</span></span><span class=line><span class=cl>End? 100%                                                                 
</span></span><span class=line><span class=cl>(parted) print                                                            
</span></span><span class=line><span class=cl>Model: Virtio Block Device (virtblk)
</span></span><span class=line><span class=cl>Disk /dev/vdb: 69.8GB
</span></span><span class=line><span class=cl>Sector size (logical/physical): 512B/512B
</span></span><span class=line><span class=cl>Partition Table: msdos
</span></span><span class=line><span class=cl>Disk Flags: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Number  Start   End     Size    Type     File system  Flags
</span></span><span class=line><span class=cl> 1      1049kB  69.8GB  69.8GB  primary  xfs          lba
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>(parted) quit                                                             
</span></span><span class=line><span class=cl>Information: You may need to update /etc/fstab.
</span></span></code></pre></td></tr></table></div></div><p>Tambahkan partisi tersebut ke dalam konfigurasi <code>/etc/fstab</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl># Mount partition for NFS server
</span></span><span class=line><span class=cl>/dev/vdb1        /mnt/storage1   xfs     defaults        0 0 
</span></span></code></pre></td></tr></table></div></div><p>Kemudian refresh partition table dengan <code>udevadm</code> dan format partisi dengan <code>mkfs</code> lalu buat direktori untuk mountpoint pada <code>/mnt/storage1</code>, jangan lupa lakukan mount.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>udevadm settle
</span></span><span class=line><span class=cl>mkfs.xfs /dev/vdb1
</span></span><span class=line><span class=cl>mkdir -p /mnt/storage1
</span></span><span class=line><span class=cl>mount -av
</span></span><span class=line><span class=cl>chmod <span class=m>777</span> -R /mnt/storage1
</span></span></code></pre></td></tr></table></div></div><p>Jika mount partition berhasil, akan muncul output seperti berikut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>mount: /mnt/storage1 does not contain SELinux labels.
</span></span><span class=line><span class=cl>       You just mounted an file system that supports labels which does not
</span></span><span class=line><span class=cl>       contain labels, onto an SELinux box. It is likely that confined
</span></span><span class=line><span class=cl>       applications will generate AVC messages and not be allowed access to
</span></span><span class=line><span class=cl>       this file system.  For more details see restorecon(8) and mount(8).
</span></span><span class=line><span class=cl>/mnt/storage1            : successfully mounted
</span></span></code></pre></td></tr></table></div></div><p>Tambahkan mountpoint tersebut ke dalam konfigurasi NFS server, lakukan export dengan <code>exportfs</code> dan jalankan service <code>nfs-server</code> dengan <a href=https://www.freedesktop.org/software/systemd/man/systemctl.html target=_blank rel="noopener noreffer">systemd</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;/mnt/storage1 *(rw,sync)&#34;</span> &gt;&gt; /etc/exports
</span></span><span class=line><span class=cl>exportfs -arv
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now nfs-server.service
</span></span><span class=line><span class=cl>systemctl status nfs-server.service
</span></span></code></pre></td></tr></table></div></div><p>Sesuaikan service yang diperbolehkan oleh <code>firewalld</code>, cukup lakukan ini di sisi <code>host1.ovirt.local</code> saja.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>firewall-cmd --permanent --add-service<span class=o>=</span>nfs
</span></span><span class=line><span class=cl>firewall-cmd --permanent --add-service<span class=o>=</span>mountd
</span></span><span class=line><span class=cl>firewall-cmd --permanent --add-service<span class=o>=</span>rpc-bind
</span></span><span class=line><span class=cl>firewall-cmd --reload
</span></span></code></pre></td></tr></table></div></div><p>Sekarang cek dari kedua sisi host apakah NFS server sudah terdeteksi.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>for</span> i in host<span class=o>{</span>1..2<span class=o>}</span>.ovirt.local<span class=p>;</span> <span class=k>do</span> ssh root@<span class=nv>$i</span> <span class=s2>&#34;showmount -e host1.ovirt.local&#34;</span><span class=p>;</span> <span class=k>done</span> 
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=self-hosted-engine>Self-hosted Engine</h2><h3 id=vm-settings>VM Settings</h3><p>Buka <code>cockpit</code> lewat web browser dengan URL <a href=https://host1.ovirt.local:9090/ovirt-dashboard#/he target=_blank rel="noopener noreffer"><strong>https://host1.ovirt.local:9090/ovirt-dashboard#/he</strong></a> untuk deploy VM Self-hosted Engine. Gunakan username <code>root</code> dan kata sandi yang telah dibuat ketika instalasi oVirt Node. Setelah berhasil login, klik <strong>Start</strong> pada <strong>Hosted Engine</strong>.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/deploy-hosted-engine.png title="Deploy Self-hosted Engine" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/deploy-hosted-engine.png data-sub-html="<h2>Deploy Self-hosted Engine</h2><p>Deploy Self-hosted Engine</p>"><img class=lazyload src=/svg/loading.min.svg data-src=deploy-hosted-engine.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/deploy-hosted-engine.png, deploy-hosted-engine.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/deploy-hosted-engine.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/deploy-hosted-engine.png></a><figcaption class=image-caption>Deploy Self-hosted Engine</figcaption></figure></p><p>Sesuaikan <strong>Engine VM FQDN</strong> dan <strong>VM IP Address</strong> dengan konfigurasi yang sudah dibuat pada <code>/etc/hosts</code>. Resize <strong>Memory Size (MiB)</strong> ke batas terendah (4096) serta <strong>Number of Virtual CPUs</strong> menjadi 1 saja, namun hal ini dapat disesuaikan dengan spesifikasi host yang kita hendaki.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-configuration.png title="Self-hosted Engine Configuration" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-configuration.png data-sub-html="<h2>Self-hosted Engine Configuration</h2><p>Self-hosted Engine Configuration</p>"><img class=lazyload src=/svg/loading.min.svg data-src=self-hosted-engine-configuration.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-configuration.png, self-hosted-engine-configuration.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-configuration.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-configuration.png></a><figcaption class=image-caption>Self-hosted Engine Configuration</figcaption></figure><figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/prepare-self-hosted-engine-vm.png title="Prepare Self-hosted Engine VM" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/prepare-self-hosted-engine-vm.png data-sub-html="<h2>Prepare Self-hosted Engine VM</h2><p>Prepare Self-hosted Engine VM</p>"><img class=lazyload src=/svg/loading.min.svg data-src=prepare-self-hosted-engine-vm.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/prepare-self-hosted-engine-vm.png, prepare-self-hosted-engine-vm.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/prepare-self-hosted-engine-vm.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/prepare-self-hosted-engine-vm.png></a><figcaption class=image-caption>Prepare Self-hosted Engine VM</figcaption></figure></p><h3 id=deployment-progress>Deployment Progress</h3><p>Jika kita lihat dari output log, deployment dijalankan oleh Ansible. Durasi yang diperlukan untuk deployment sangat bergantung pada kecepatan koneksi jaringan internet, spesifikasi VM host, serta hardware komputer yang kita miliki. Dalam kasus saya, internet berkecepatan sekitar 5MB/s dengan spesifikasi host pada artikel ini, memakan waktu hingga sekitar 1 jam.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-deployment-progess.png title="Self-hosted Engine Deployment Progess" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-deployment-progess.png data-sub-html="<h2>Self-hosted Engine Deployment Progess</h2><p>Self-hosted Engine Deployment Progess</p>"><img class=lazyload src=/svg/loading.min.svg data-src=self-hosted-engine-deployment-progess.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-deployment-progess.png, self-hosted-engine-deployment-progess.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-deployment-progess.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/self-hosted-engine-deployment-progess.png></a><figcaption class=image-caption>Self-hosted Engine Deployment Progess</figcaption></figure></p><h3 id=storage-domain>Storage Domain</h3><p>Seusai VM Self-hosted Engine sudah berhasil dinyalakan, kita lanjutkan dengan membuat Storage Domain. Fungsinya nanti adalah untuk menampung berbagai <em>images</em> baik file ISO Installer maupun virtual disk bagi VM yang akan dibuat. Karena sebelumnya kita sudah membuat NFS server, maka seharusnya sekarang tinggal kita hubungkan saja seperti berikut.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/add-nfs-as-storage-domain.png title="Add NFS as Storage Domain" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/add-nfs-as-storage-domain.png data-sub-html="<h2>Add NFS as Storage Domain</h2><p>Add NFS as Storage Domain</p>"><img class=lazyload src=/svg/loading.min.svg data-src=add-nfs-as-storage-domain.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/add-nfs-as-storage-domain.png, add-nfs-as-storage-domain.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/add-nfs-as-storage-domain.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/add-nfs-as-storage-domain.png></a><figcaption class=image-caption>Add NFS as Storage Domain</figcaption></figure></p><h3 id=healthcheck-hosted-engine>Healthcheck Hosted Engine</h3><p>Masuk ke shell untuk user <code>root</code> pada <code>host1.ovirt.local</code> misalnya dengan SSH, dan periksa apakah VM Self-hosted Enginer dalam keadaan baik.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[root@host1 ~]# hosted-engine --vm-status
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--== Host host1.ovirt.local (id: 1) status ==--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host ID                            : 1
</span></span><span class=line><span class=cl>Host timestamp                     : 10187
</span></span><span class=line><span class=cl>Score                              : 3400
</span></span><span class=line><span class=cl>Engine status                      : {&#34;vm&#34;: &#34;up&#34;, &#34;health&#34;: &#34;good&#34;, &#34;detail&#34;: &#34;Up&#34;}
</span></span><span class=line><span class=cl>Hostname                           : host1.ovirt.local
</span></span><span class=line><span class=cl>Local maintenance                  : False
</span></span><span class=line><span class=cl>stopped                            : False
</span></span><span class=line><span class=cl>crc32                              : a1c1f3b9
</span></span><span class=line><span class=cl>conf_on_shared_storage             : True
</span></span><span class=line><span class=cl>local_conf_timestamp               : 10187
</span></span><span class=line><span class=cl>Status up-to-date                  : True
</span></span><span class=line><span class=cl>Extra metadata (valid at timestamp):
</span></span><span class=line><span class=cl>	metadata_parse_version=1
</span></span><span class=line><span class=cl>	metadata_feature_version=1
</span></span><span class=line><span class=cl>	timestamp=10187 (Tue Nov 30 08:55:06 2021)
</span></span><span class=line><span class=cl>	host-id=1
</span></span><span class=line><span class=cl>	score=3400
</span></span><span class=line><span class=cl>	vm_conf_refresh_time=10187 (Tue Nov 30 08:55:06 2021)
</span></span><span class=line><span class=cl>	conf_on_shared_storage=True
</span></span><span class=line><span class=cl>	maintenance=False
</span></span><span class=line><span class=cl>	state=EngineUp
</span></span><span class=line><span class=cl>	stopped=False
</span></span></code></pre></td></tr></table></div></div><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw"></i>Tips<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Selagi masih dalam shell <code>host1.ovirt.local</code> coba untuk SSH ke <code>hosted-engine.ovirt.local</code> dan lakukan konfigurasi file <code>/etc/hosts</code> sesuai dengan yang sebelumnya telah kita bahas di bagian <a href=#network rel><strong>Network</strong></a>. Login SSH menggunakan user <code>root</code> dan kata sandi yang telah dibuat sebelumnya.</div></div></div><h3 id=ovirt-webmanager>oVirt Webmanager</h3><p>Jika VM Self-hosted Engine dalam keadaan baik, kita dapat membuka Web Manager untuk mengelola oVirt lewat web browser dengan alamat <a href=https://hosted-engine.ovirt.local target=_blank rel="noopener noreffer"><strong>https://hosted-engine.ovirt.local</strong></a> menggunakan username <code>admin</code> dan kata sandi yang telah kita buat sebelumnya pada saat melakukan konfigurasi <a href=#vm-settings rel>VM Settings</a>.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/ovirt-manager-web-portal.png title="oVirt Manager Web Portal" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/ovirt-manager-web-portal.png data-sub-html="<h2>oVirt Manager Web Portal</h2><p>oVirt Manager Web Portal</p>"><img class=lazyload src=/svg/loading.min.svg data-src=ovirt-manager-web-portal.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/ovirt-manager-web-portal.png, ovirt-manager-web-portal.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/ovirt-manager-web-portal.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/ovirt-manager-web-portal.png></a><figcaption class=image-caption>oVirt Manager Web Portal</figcaption></figure></p><hr><h2 id=add-host>Add Host</h2><p>Tambahkan <code>host2.ovirt.local</code> ke datacenter oVirt yang berhasil kita deploy. Caranya adalah dengan masuk ke menu <a href=https://hosted-engine.ovirt.local/ovirt-engine/webadmin/#hosts target=_blank rel="noopener noreffer"><strong>Hosts</strong></a> pada oVirt Webmanager Web Portal. Lalu pilih <strong>New</strong> dan masukkan hostname serta kata sandi dari user <code>root</code>. Tunggu beberapa saat, sampai host baru reboot dan berhasil join ke datacenter oVirt.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/add-host.png title="Add Host" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/add-host.png data-sub-html="<h2>Add Host</h2><p>Add Host</p>"><img class=lazyload src=/svg/loading.min.svg data-src=add-host.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/add-host.png, add-host.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/add-host.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/add-host.png></a><figcaption class=image-caption>Add Host</figcaption></figure></p><p>Bila berhasil, nantinya <code>host2.ovirt.local</code> akan muncul di oVirt Webmanager, total jumlah Host akan bertambah, dan ada alert seperti berikut.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/add-host-success.png title="Add Host Success" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/add-host-success.png data-sub-html="<h2>Add Host Success</h2><p>Add Host Success</p>"><img class=lazyload src=/svg/loading.min.svg data-src=add-host-success.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/add-host-success.png, add-host-success.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/add-host-success.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/add-host-success.png></a><figcaption class=image-caption>Add Host Success</figcaption></figure><figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/tasks-success.png title="Tasks Success" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/tasks-success.png data-sub-html="<h2>Tasks Success</h2><p>Tasks Success</p>"><img class=lazyload src=/svg/loading.min.svg data-src=tasks-success.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/tasks-success.png, tasks-success.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/tasks-success.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/tasks-success.png></a><figcaption class=image-caption>Tasks Success</figcaption></figure></p><hr><h2 id=upload-iso>Upload ISO</h2><p>Sayangnya untuk mengunggah file installer ISO ke oVirt tidak terasa begitu ramah pengguna, kita perlu melakukannya secara manual seperti berikut.</p><h3 id=mountpoint-iso>Mountpoint ISO</h3><p>Buat sebuah direktori baru bernama <code>nfs-iso</code> dalam mountpoint NFS untuk Storage Domain khusus bagi ISO.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir -p /mnt/storage1/nfs-iso
</span></span><span class=line><span class=cl>chmod <span class=m>777</span> /mnt/storage1/nfs-iso
</span></span></code></pre></td></tr></table></div></div><h3 id=new-storage-domain>New Storage Domain</h3><p>Pada oVirt Webmanager pilih masuk ke bagian <a href=https://hosted-engine.ovirt.local/ovirt-engine/webadmin/#storage target=_blank rel="noopener noreffer"><strong>Storage Domains</strong></a>, kemudian klik <strong>New Domains</strong>.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain.png title="New Storage Domain" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain.png data-sub-html="<h2>New Storage Domain</h2><p>New Storage Domain</p>"><img class=lazyload src=/svg/loading.min.svg data-src=new-storage-domain.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain.png, new-storage-domain.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain.png></a><figcaption class=image-caption>New Storage Domain</figcaption></figure><figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain-success.png title="New Storage Domain Successfully Created" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain-success.png data-sub-html="<h2>New Storage Domain Successfully Created</h2><p>New Storage Domain Successfully Created</p>"><img class=lazyload src=/svg/loading.min.svg data-src=new-storage-domain-success.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain-success.png, new-storage-domain-success.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain-success.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/new-storage-domain-success.png></a><figcaption class=image-caption>New Storage Domain Successfully Created</figcaption></figure></p><h3 id=enable-user>Enable User</h3><p>Kita ubah shell milik user <code>vdsm</code> dari yang sebelumnya <code>/sbin/nologin</code> menjadi <code>/bin/bash</code> lalu login ke dalam user tersebut.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>usermod -s /bin/bash vdsm
</span></span><span class=line><span class=cl>su - vdsm
</span></span></code></pre></td></tr></table></div></div><h3 id=lokasi-direktori>Lokasi Direktori</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tree /rhev/data-center/mnt
</span></span></code></pre></td></tr></table></div></div><p>Setelah menjalankan perintah di atas, perhatikan output dari perintah <code>tree</code> dengan teliti karena kita akan membutuhkan letak <em>full path</em> dari sebuah direktori bernama <code>11111111-1111-1111-1111-111111111111</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/rhev/data-center/mnt
</span></span><span class=line><span class=cl>└── host1.ovirt.local:_mnt_storage1_nfs-iso
</span></span><span class=line><span class=cl>    └── 7818ab21-eb15-4421-bd17-68d1f3a772b4
</span></span><span class=line><span class=cl>        ├── dom_md
</span></span><span class=line><span class=cl>        │   ├── ids
</span></span><span class=line><span class=cl>        │   ├── inbox
</span></span><span class=line><span class=cl>        │   ├── leases
</span></span><span class=line><span class=cl>        │   ├── metadata
</span></span><span class=line><span class=cl>        │   └── outbox
</span></span><span class=line><span class=cl>        └── images
</span></span><span class=line><span class=cl>            └── 11111111-1111-1111-1111-111111111111
</span></span></code></pre></td></tr></table></div></div><h3 id=rsync-file>Rsync File</h3><p>Masih di dalam user <code>vdsm</code> kita dapat menyalin file dari komputer lain dengan <code>rsync</code> atau <code>scp</code> melalui SSH.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>rsync -aPv pwn3r@192.168.122.1:/run/media/pwn3r/DATA/ISOs/ubuntu-18.04.6-live-server-amd64.iso /rhev/data-center/mnt/host1.ovirt.local<span class=se>\:</span>_mnt_storage1_nfs-iso/7818ab21-eb15-4421-bd17-68d1f3a772b4/images/11111111-1111-1111-1111-111111111111/
</span></span></code></pre></td></tr></table></div></div><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw"></i>Perhatian<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Pemilik IP <code>192.168.122.1</code> adalah komputer saya dengan username <code>pwn3r</code>, sesuaikan dengan environment kalian masing - masing. Dari sini saya menyalin file ISO Ubuntu Server dari komputer saya menuju ke Storage Domain di dalam oVirt.</div></div></div><h3 id=disable-user>Disable User</h3><p>Jika sudah, jangan lupa untuk logout dari user <code>vdsm</code> dan mematikan akses shell.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>logout</span>
</span></span><span class=line><span class=cl>usermod -s /sbin/nologin vdsm
</span></span></code></pre></td></tr></table></div></div><h3 id=check-iso-file>Check ISO File</h3><p>Coba lihat dari sisi oVirt Webmanager apakah file ISO sudah muncul seberti berikut ini.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/uploaded-iso.png title="Uploaded ISO" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/uploaded-iso.png data-sub-html="<h2>Uploaded ISO</h2><p>Uploaded ISO</p>"><img class=lazyload src=/svg/loading.min.svg data-src=uploaded-iso.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/uploaded-iso.png, uploaded-iso.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/uploaded-iso.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/uploaded-iso.png></a><figcaption class=image-caption>Uploaded ISO</figcaption></figure></p><hr><h2 id=create-vm>Create VM</h2><h3 id=new-vm>New VM</h3><p>Buka menu <a href=https://hosted-engine.ovirt.local/ovirt-engine/webadmin/#vms target=_blank rel="noopener noreffer"><strong>Virtual Machines</strong></a> pada oVirt Webmanager lalu pilih <strong>New</strong>.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/create-new-vm.png title="Create New VM" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/create-new-vm.png data-sub-html="<h2>Create New VM</h2><p>Create New VM</p>"><img class=lazyload src=/svg/loading.min.svg data-src=create-new-vm.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/create-new-vm.png, create-new-vm.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/create-new-vm.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/create-new-vm.png></a><figcaption class=image-caption>Create New VM</figcaption></figure></p><p>Silahkan buat disk baru yang akan digunakan oleh VM baru.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/create-disk-for-new-vm.png title="Create Disk for New VM" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/create-disk-for-new-vm.png data-sub-html="<h2>Create Disk for New VM</h2><p>Create Disk for New VM</p>"><img class=lazyload src=/svg/loading.min.svg data-src=create-disk-for-new-vm.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/create-disk-for-new-vm.png, create-disk-for-new-vm.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/create-disk-for-new-vm.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/create-disk-for-new-vm.png></a><figcaption class=image-caption>Create Disk for New VM</figcaption></figure></p><p>Sesuaikan resource memori dan CPU yang akan dialokasikan untuk VM.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/resource-limit-for-new-vm.png title="Resource Limit for New VM" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/resource-limit-for-new-vm.png data-sub-html="<h2>Resource Limit for New VM</h2><p>Resource Limit for New VM</p>"><img class=lazyload src=/svg/loading.min.svg data-src=resource-limit-for-new-vm.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/resource-limit-for-new-vm.png, resource-limit-for-new-vm.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/resource-limit-for-new-vm.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/resource-limit-for-new-vm.png></a><figcaption class=image-caption>Resource Limit for New VM</figcaption></figure></p><h3 id=install-os-on-vm-with-iso>Install OS on VM with ISO</h3><p>Saat pertamakali membuat, VM akan dalam keadaan <em>Powered Off</em>, pilih <strong>Run Once</strong> dan <em>attach</em> file ISO yang telah kita upload sebelumnya.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/run-once-for-os-installation.png title="Run Once For OS Installation" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/run-once-for-os-installation.png data-sub-html="<h2>Run Once For OS Installation</h2><p>Run Once For OS Installation</p>"><img class=lazyload src=/svg/loading.min.svg data-src=run-once-for-os-installation.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/run-once-for-os-installation.png, run-once-for-os-installation.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/run-once-for-os-installation.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/run-once-for-os-installation.png></a><figcaption class=image-caption>Run Once For OS Installation</figcaption></figure></p><p>Untuk melakukan remote menggunakan protokol <a href=https://spice-space.org target=_blank rel="noopener noreffer"><code>SPICE</code></a>, klik VM yang kita nyalakan dan pilih <strong>Console</strong>. Web Browser akan mengunduh sebuah file bernama <code>console.vv</code> yang dapat kita buka menggunakan tool bernama <code>virt-viewer</code>. Jika belum ada, silahkan install terlebih dahulu pada komputer kalian.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo pacman -Sy virt-viewer
</span></span></code></pre></td></tr></table></div></div><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw"></i>Info<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>Komputer saya menjalankan distro <a href=https://artixlinux.org target=_blank rel="noopener noreffer">Artix Linux</a> sehingga menggunakan package manager <code>pacman</code>. Silahkan sesuaikan dengan distro yang kalian gunakan.</div></div></div><p>Berikut ini adalah tampilan dari VM yang berjalan di atas oVirt, sedang menjalankan instalasi Ubuntu Server menggunakan ISO yang telah kita upload ke Storage Domain lewat NFS.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/installing-ubuntu-server.png title="Installing Ubuntu Server" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/installing-ubuntu-server.png data-sub-html="<h2>Installing Ubuntu Server</h2><p>Installing Ubuntu Server</p>"><img class=lazyload src=/svg/loading.min.svg data-src=installing-ubuntu-server.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/installing-ubuntu-server.png, installing-ubuntu-server.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/installing-ubuntu-server.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/installing-ubuntu-server.png></a><figcaption class=image-caption>Installing Ubuntu Server</figcaption></figure></p><h3 id=eject-iso>Eject ISO</h3><p>Ketika proses instalasi telah selesai, Ubuntu akan meminta reboot VM. Jangan lupa untuk <em>eject</em> ISO terlebih dahulu agar VM booting menggunakan disk.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/eject-iso.png title="Eject ISO" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/eject-iso.png data-sub-html="<h2>Eject ISO</h2><p>Eject ISO</p>"><img class=lazyload src=/svg/loading.min.svg data-src=eject-iso.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/eject-iso.png, eject-iso.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/eject-iso.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/eject-iso.png></a><figcaption class=image-caption>Eject ISO</figcaption></figure></p><h3 id=uji-coba>Uji Coba</h3><p>Instalasi OS telah berhasil dilakukan pada VM di atas, jika dilihat pada sisi oVirt Webmanager akan terlihat statusnya <strong>Up</strong> yang menandakan VM telah berjalan. VM juga sudah dapat mengakses internet<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/vm-running.png title="VM Running" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/vm-running.png data-sub-html="<h2>VM Running</h2><p>VM Running</p>"><img class=lazyload src=/svg/loading.min.svg data-src=vm-running.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/vm-running.png, vm-running.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/vm-running.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/vm-running.png></a><figcaption class=image-caption>VM Running</figcaption></figure></p><p>Sementara berikut ini adalah Overview dari oVirt Webmanager, terlihat bahwa dua VM sedang berjalan dan resource berkurang karena digunakan oleh VM baru.<figure><a class=lightgallery href=/virtualisasi-infrastruktur-dengan-ovirt/ovirt-overview.png title="oVirt Overview" data-thumbnail=/virtualisasi-infrastruktur-dengan-ovirt/ovirt-overview.png data-sub-html="<h2>oVirt Overview</h2><p>oVirt Overview</p>"><img class=lazyload src=/svg/loading.min.svg data-src=ovirt-overview.png data-srcset="/virtualisasi-infrastruktur-dengan-ovirt/ovirt-overview.png, ovirt-overview.png 1.5x, /virtualisasi-infrastruktur-dengan-ovirt/ovirt-overview.png 2x" data-sizes=auto alt=/virtualisasi-infrastruktur-dengan-ovirt/ovirt-overview.png></a><figcaption class=image-caption>oVirt Overview</figcaption></figure></p><hr><h2 id=kesimpulan>Kesimpulan</h2><p>Tentunya di production grade RHV lebih banyak diminati karena tersedianya support, dan oVirt menjadi alternatif jika ingin merasakan teknologi virtualisasi ini tanpa perlu biaya subscription. Harap dicatat bahwa dibutuhkan <em>effort</em> lebih untuk produk community yang dapat dipakai secara bebas tanpa biaya langganan jika misalnya kita mendapati masalah atau issue. Selain RHV dan oVirt, masih ada banyak teknologi di level hypervisor yang dapat kita jadikan referensi seperti misalnya vSphere, Proxmox, ESXi, hingga OpenStack. Dari segi fitur, lumayan banyak yang bisa kita manfaatkan di oVirt dan RHV. Namun untuk Web Interface saya rasa masih kurang <em>user friendly</em> jika dibandingkan kompetitornya.</p><hr><h2 id=referensi>Referensi</h2><ul><li><a href=https://ovirt.org/documentation/installing_ovirt_as_a_self-hosted_engine_using_the_command_line/index.html target=_blank rel="noopener noreffer">ovirt.org/documentation/installing_ovirt_as_a_self-hosted_engine_using_the_command_line/index.html</a></li><li><a href=https://www.ovirt.org/develop/architecture/architecture.html target=_blank rel="noopener noreffer">ovirt.org/develop/architecture/architecture.html</a></li><li><a href=https://www.linux-kvm.org/page/FAQ target=_blank rel="noopener noreffer">www.linux-kvm.org/page/FAQ</a></li><li><a href=https://wiki.archlinux.org/title/libvirt target=_blank rel="noopener noreffer">wiki.archlinux.org/title/libvirt</a></li><li><a href=https://wiki.archlinux.org/title/QEMU target=_blank rel="noopener noreffer">wiki.archlinux.org/title/QEMU</a></li><li><a href=https://wiki.archlinux.org/title/KVM target=_blank rel="noopener noreffer">wiki.archlinux.org/title/KVM</a></li><li><a href=http://www.desktop-virtualization.com/2008/05/01/qumranet-solid-ice target=_blank rel="noopener noreffer">www.desktop-virtualization.com/2008/05/01/qumranet-solid-ice</a></li><li><a href=http://www.desktop-virtualization.com/2008/09/09/redhat-acquires-qumranet-for-107m target=_blank rel="noopener noreffer">www.desktop-virtualization.com/2008/09/09/redhat-acquires-qumranet-for-107m</a></li><li><a href=https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/administration_guide/index#Copy_ISO_to_ISO_domain-storage_tasks target=_blank rel="noopener noreffer">access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/administration_guide/index#Copy_ISO_to_ISO_domain-storage_tasks</a></li><li><a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/exporting-nfs-shares_deploying-different-types-of-servers target=_blank rel="noopener noreffer">access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/exporting-nfs-shares_deploying-different-types-of-servers</a></li><li><a href=https://ubuntu.com/tutorials/install-ubuntu-server target=_blank rel="noopener noreffer">ubuntu.com/tutorials/install-ubuntu-server</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-11-30</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/virtualisasi-infrastruktur-dengan-ovirt/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/virtualization/>Virtualization</a>,&nbsp;<a href=/tags/ovirt/>oVirt</a>,&nbsp;<a href=/tags/rhev/>RHEV</a>,&nbsp;<a href=/tags/rhv/>RHV</a>,&nbsp;<a href=/tags/hypervisor/>Hypervisor</a>,&nbsp;<a href=/tags/infrastructure/>Infrastructure</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/monitoring-kubernetes-dengan-influxdb-v2/ class=prev rel=prev title="Monitoring Kubernetes dengan InfluxDB v2"><i class="fas fa-angle-left fa-fw"></i>Monitoring Kubernetes dengan InfluxDB v2</a>
<a href=/plug-and-play-usb-devices-dengan-udev-rules/ class=next rel=next title="Plug and Play USB Devices dengan Udev Rules">Plug and Play USB Devices dengan Udev Rules<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=http://github.com/anwareset target=_blank>anwareset</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=https://anwars-blog.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},data:{"id-1":"init\u0026nbsp","id-2":"init\u0026nbsp"},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},typeit:{cursorChar:"\u0026nbsp _",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:75}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>